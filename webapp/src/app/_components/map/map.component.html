<!-- Map -->
<div id="map_canvas">
  <!-- Toolbar -->
  <app-toolbar [darkMode]="darkMode"></app-toolbar>

  <!-- Info, wenn Server nicht erreichbar ist und die Konfiguration fehlschlägt -->
  <p
    *ngIf="infoConfigurationFailureMessage"
    style="position: absolute; top: 4rem; left: 0.5rem; z-index: 2000"
  >
    {{ infoConfigurationFailureMessage }}
  </p>

  <!-- Hover-Info-Box Variante (wird nur auf dem Desktop angezeigt) -->
  <mat-card
    id="smallInfoBox"
    *ngIf="showSmallInfo && hoveredAircraft"
    [style.top.px]="topValue"
    [style.left.px]="leftValue"
    [ngClass]="
      darkMode ? 'background-and-color-dark' : 'background-and-color-light'
    "
  >
    <div *ngIf="hoveredAircraft">
      <mat-card-header id="hoveredAircraftPopupHeader">
        <!-- flightId -->
        <mat-card-title *ngIf="hoveredAircraft.flightId" style="color: #f8c023">
          {{ hoveredAircraft.flightId }}
        </mat-card-title>
        <!-- hex -->
        <mat-card-subtitle *ngIf="hoveredAircraft.hex" style="color: #d5d5d5">{{
          hoveredAircraft.hex
        }}</mat-card-subtitle>
      </mat-card-header>

      <table>
        <ng-container *ngFor="let item of hoveredAircraft.attributes">
          <tr
            [ngClass]="
              darkMode
                ? 'background-and-color-dark airportDataPopup-tr-dark'
                : 'background-and-color-light color-grey'
            "
          >
            <td
              [ngClass]="
                darkMode
                  ? 'background-and-color-dark airportDataPopup-td-dark'
                  : 'background-and-color-light color-grey'
              "
            >
              <div>
                <p style="font-size: small; padding-inline: 0.5rem">
                  {{ item.key }}
                </p>
              </div>
            </td>

            <td
              [ngClass]="
                darkMode
                  ? 'background-and-color-dark airportDataPopup-td-dark'
                  : 'background-and-color-light'
              "
            >
              <div>
                <p
                  style="
                    font-size: small;
                    font-weight: bold;
                    padding-inline: 0.5rem;
                  "
                >
                  {{ item.value }}
                </p>
              </div>
            </td>
          </tr>
        </ng-container>
      </table>
    </div>
  </mat-card>

  <!-- Popup für RangeData -->
  <div id="rangeDataPopup" [style.bottom]="rangeDataPopupBottomValue">
    <div *ngIf="showPopupRangeDataPoint && rangeDataPoint">
      <mat-card-content>
        <mat-grid-list
          cols="2"
          rowHeight="1rem"
          [ngClass]="
            darkMode ? 'background-color-dark' : 'background-color-light'
          "
        >
          <!-- hex label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Hex</p>
            </div>
          </mat-grid-tile>

          <!-- hex value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.hex"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.hex }}
              </p>
              <p
                *ngIf="!rangeDataPoint.hex"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- latitude label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Latitude</p>
            </div>
          </mat-grid-tile>

          <!-- latitude value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.x"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.x }}°
              </p>
              <p
                *ngIf="!rangeDataPoint.x"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- longitude label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Longitude</p>
            </div>
          </mat-grid-tile>

          <!-- longitude value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.y"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.y }}°
              </p>
              <p
                *ngIf="!rangeDataPoint.y"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- type label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Type</p>
            </div>
          </mat-grid-tile>

          <!-- type value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.type"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.type }}
              </p>
              <p
                *ngIf="!rangeDataPoint.type"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- category label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Category</p>
            </div>
          </mat-grid-tile>

          <!-- category value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.category"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.category }}
              </p>
              <p
                *ngIf="!rangeDataPoint.category"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- registration label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Registration</p>
            </div>
          </mat-grid-tile>

          <!-- registration value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.registration"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.registration }}
              </p>
              <p
                *ngIf="!rangeDataPoint.registration"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- flightId label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">FlightId</p>
            </div>
          </mat-grid-tile>

          <!-- flightId value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.flightId"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.flightId }}
              </p>
              <p
                *ngIf="!rangeDataPoint.flightId"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- altitude label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Altitude</p>
            </div>
          </mat-grid-tile>

          <!-- altitude value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.altitude"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.altitude }} ft
              </p>
              <p
                *ngIf="!rangeDataPoint.altitude"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- distance label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Distance</p>
            </div>
          </mat-grid-tile>

          <!-- distance value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.distance"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.distance }} km
              </p>
              <p
                *ngIf="!rangeDataPoint.distance"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- feederList label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Feeder</p>
            </div>
          </mat-grid-tile>

          <!-- feederList value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.feederList"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.feederList }}
              </p>
              <p
                *ngIf="!rangeDataPoint.feederList"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- sourceList label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Source</p>
            </div>
          </mat-grid-tile>

          <!-- sourceList value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.sourceList"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.sourceList }}
              </p>
              <p
                *ngIf="!rangeDataPoint.sourceList"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>

          <!-- timestamp label -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p style="font-size: small">Timestamp</p>
            </div>
          </mat-grid-tile>

          <!-- timestamp value -->
          <mat-grid-tile
            colspan="1"
            rowspan="1"
            [ngClass]="
              darkMode
                ? 'background-and-color-dark'
                : 'background-and-color-light'
            "
          >
            <div>
              <p
                *ngIf="rangeDataPoint.timestamp"
                style="font-size: small; font-weight: bold"
              >
                {{ rangeDataPoint.timestamp }}
              </p>
              <p
                *ngIf="!rangeDataPoint.timestamp"
                style="font-size: small; font-weight: bold"
              >
                N/A
              </p>
            </div>
          </mat-grid-tile>
        </mat-grid-list>
      </mat-card-content>
    </div>
  </div>

  <!-- Popup für AirportData -->
  <mat-card
    id="airportDataPopup"
    [style.bottom]="airportDataPopupBottomValue"
    [ngClass]="
      darkMode ? 'background-and-color-dark' : 'background-and-color-light'
    "
  >
    <div *ngIf="airportDataPoint">
      <mat-card-header id="airportDataPopupHeader">
        <!-- flightId -->
        <mat-card-title *ngIf="airportDataPoint.icao" style="color: #f8c023">
          {{ airportDataPoint.icao }}
        </mat-card-title>
      </mat-card-header>

      <table>
        <ng-container *ngFor="let item of airportDataPoint.attributes">
          <tr
            [ngClass]="
              darkMode
                ? 'background-and-color-dark airportDataPopup-tr-dark'
                : 'background-and-color-light color-grey'
            "
          >
            <td
              [ngClass]="
                darkMode
                  ? 'background-and-color-dark airportDataPopup-td-dark'
                  : 'background-and-color-light color-grey'
              "
            >
              <div>
                <p style="font-size: small; padding-inline: 0.5rem">
                  {{ item.key }}
                </p>
              </div>
            </td>

            <td
              [ngClass]="
                darkMode
                  ? 'background-and-color-dark airportDataPopup-td-dark'
                  : 'background-and-color-light'
              "
            >
              <div>
                <p
                  style="
                    font-size: small;
                    font-weight: bold;
                    padding-inline: 0.5rem;
                  "
                >
                  {{ item.value }}
                </p>
              </div>
            </td>
          </tr>
        </ng-container>
      </table>
    </div>
  </mat-card>

  <!-- Info-Box -->
  <app-info
    (showRouteEvent)="receiveToggleShowAircraftRoute($event)"
    id="aircraft-info"
    *ngIf="displayAircraftInfo"
    [aircraft]="aircraft"
    [darkMode]="darkMode"
  ></app-info>
</div>
